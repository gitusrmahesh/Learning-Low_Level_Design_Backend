<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLD Bootcamp | Day 7: Static Classes & Records</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;600;700;800&family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <!-- Chosen Palette: Warm Neutrals with Indigo Accent -->
    <!-- Application Structure Plan: A three-column responsive layout is used. The main content resides in a central column for optimal readability. A sticky Table of Contents is positioned on the right for easy navigation within this comprehensive lesson. This structure transforms the linear document into a highly navigable and user-friendly learning experience, allowing users to jump between deep-dive sections without losing context. -->
    <!-- Visualization & Content Choices: 
        1. Report Info: Core & advanced concepts. Goal: Inform/Organize. Viz/Method: Styled text with a sticky Table of Contents. Interaction: Smooth scrolling to sections. Justification: Provides excellent structure for a long, detailed document. Library/Method: HTML/CSS/JS.
        2. Report Info: Code examples and solutions. Goal: Utility. Viz/Method: Syntax-highlighted code blocks. Interaction: Copy-to-clipboard button. Justification: Improves practical utility for developers. Library/Method: Vanilla JS.
        3. Report Info: UML Diagrams and concept visualizations. Goal: Visualize structure. Viz/Method: Structured HTML/Tailwind to mimic diagrams. Interaction: None. Justification: Provides visual aids without external libraries, adhering to constraints.
        4. Report Info: In-depth comparisons (Static vs. Singleton, Class vs. Record). Goal: Compare/Contrast. Viz/Method: Detailed HTML tables. Justification: Clearly organizes complex comparisons for easy understanding.
        5. Report Info: Knowledge Check Quiz. Goal: Assess/Engage. Viz/Method: Interactive multiple-choice form. Interaction: Instant feedback on answers. Justification: Transforms a static quiz into an active learning tool. I've increased the number of questions for a more thorough assessment. Library/Method: Vanilla JS.
        6. Report Info: Self-Assessment Challenge. Goal: Apply/Test. Viz/Method: Problem statement with a hidden, button-toggled detailed solution. Justification: Allows users to apply their knowledge in a practical scenario before viewing the expert solution. Library/Method: Vanilla JS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
            color: #1f2937; /* gray-800 */
        }
        h1, h2, h3, .font-lexend {
            font-family: 'Lexend', sans-serif;
        }
        pre, code {
            font-family: 'Roboto Mono', monospace;
        }
        .section-target {
            scroll-margin-top: 80px;
        }
        .toc-link.active {
            color: #4338ca; /* indigo-700 */
            font-weight: 600;
            transform: translateX(4px);
        }
        .code-block {
            position: relative;
        }
        .copy-button {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background-color: #374151;
            color: #d1d5db;
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s;
            border: 1px solid #4b5563;
        }
        .code-block:hover .copy-button {
            opacity: 1;
        }
        .copy-button:hover {
            background-color: #4b5563;
        }
        .uml-underline {
            text-decoration: underline;
        }
        .prose strong { color: #1e293b; }
        .prose :where(code):not(:where([class~="not-prose"] *))::before,
        .prose :where(code):not(:where([class~="not-prose"] *))::after {
            content: "";
        }
        .prose :where(code):not(:where([class~="not-prose"] *)) {
            font-weight: 500;
            background-color: #eef2ff;
            color: #4338ca;
            padding: 2px 6px;
            border-radius: 4px;
        }
        .solution-hidden { display: none; }
    </style>
</head>
<body class="bg-slate-50">

    <div class="bg-slate-100/80 border-b border-slate-200">
        <div class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 relative">
            <header class="text-center">
                <h1 class="text-4xl sm:text-5xl font-extrabold text-slate-800 mt-1 tracking-tight font-lexend">Low-Level Design Bootcamp</h1>
                <p class="mt-3 text-slate-600 max-w-xl mx-auto">Your 60-Day Interactive Roadmap to Mastering Backend Engineering.</p>
            </header>
            <a href="roadmap.html?week=1" class="absolute top-1/2 -translate-y-1/2 right-4 sm:right-6 lg:right-8 bg-slate-200 text-slate-700 text-sm font-semibold py-2 px-4 rounded-lg hover:bg-slate-300 transition-colors shadow-sm">
                Return to Homepage
            </a>
        </div>
    </div>

    <div class="max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex flex-col lg:flex-row lg:gap-8">
            <!-- Table of Contents (Right Sidebar for lg screens) -->
            <aside class="hidden lg:block w-72 flex-shrink-0 lg:order-2">
                <div class="sticky top-8 py-8">
                    <h3 class="font-semibold text-slate-800 mb-4">On This Page</h3>
                    <nav id="toc-nav" class="flex flex-col space-y-2 text-sm">
                        <!-- TOC links will be injected by JS -->
                    </nav>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="flex-1 py-8 lg:py-12 lg:order-1 min-w-0">
                <header class="mb-12">
                    <p class="text-indigo-600 font-semibold">LLD Bootcamp: Day 7</p>
                    <h1 class="text-4xl font-extrabold tracking-tight text-slate-900 mt-2">The Architect's Toolkit: Static Classes & Records</h1>
                    <p class="mt-3 text-lg text-slate-600">A deep dive into C#'s specialized types for utility patterns and immutable data modeling.</p>
                </header>

                <div id="main-content" class="prose prose-slate max-w-none prose-h2:text-slate-900 prose-h2:font-bold prose-h2:tracking-tight prose-h3:text-slate-800 prose-h3:font-semibold prose-h4:text-indigo-600 prose-h4:font-semibold prose-a:text-indigo-600">
                    
                    <section id="s1" class="section-target mb-16">
                        <h2 class="border-b border-slate-200 pb-3 mb-6">Section 1: The Utility Pattern â€” Static Classes</h2>
                        <p>In object-oriented programming, the class is the fundamental blueprint for objects encapsulating state and behavior. Yet, a frequent design challenge emerges: where do we place functionality that is inherently stateless and doesn't logically belong to any object instance? Forcing pure actions, like mathematical calculations or file operations, into an instantiable class can feel artificial, requiring developers to create an object just to call one method. Static classes in C# solve this by providing a dedicated container for methods and data that are global to an application's scope.</p>
                        
                        <h3 id="s1-1" class="section-target mt-10">1.1. Motivation & Core Use Cases</h3>
                        <p>Static classes are essential for grouping related, stateless utility functions. The .NET Framework's <code>System.Math</code> class is a prime example. It offers mathematical operations (<code>Sqrt</code>, <code>Max</code>, <code>Sin</code>) that operate solely on their inputs. It would be inefficient to write <code>Math myMath = new Math();</code> when a direct call, <code>Math.Sqrt(25);</code>, is more intuitive.</p>
                        <ul class="list-disc pl-5 mt-4 space-y-2">
                            <li><strong>Utility/Helper Functions:</strong> The most common use case. Classes like <code>FileUtils</code>, <code>StringUtils</code>, or <code>ValidationUtils</code> group related functions.</li>
                            <li><strong>Extension Methods:</strong> All extension methods must be defined within a static class. This allows you to "add" methods to existing types without modifying them.</li>
                            <li><strong>Constants and Readonly Fields:</strong> A static class can serve as a centralized, non-instantiable container for global constants (e.g., <code>public const string ApiKey = "...";</code>).</li>
                        </ul>
                        
                        <div class="mt-6 p-4 bg-indigo-50 border-l-4 border-indigo-400 rounded-r-lg not-prose">
                            <h4 class="font-semibold text-indigo-800 text-base">Analogy: The Public Workshop</h4>
                            <p class="text-slate-700 mt-2 text-sm">Think of a static class as a public workshop equipped with specialized tools (static methods). Anyone can use the tools without building a personal workshop (<code>new Workshop()</code>). The tools are shared, globally accessible, and their function is independent of the user. The workshop itself is a location for specific functions, not an object you possess.</p>
                        </div>
                        
                        <h3 id="s1-2" class="section-target mt-10">1.2. Anatomy of a Static Class</h3>
                        <p>The compiler enforces several strict rules for static classes, ensuring they adhere to their stateless, non-instantiable design intent.</p>
                        
                        <h4 class="mt-6">Syntax: Declaration</h4>
                        <div class="code-block mt-2">
                           <pre class="p-4 rounded-lg overflow-x-auto"><code class="language-csharp">public static class MyUtils
{
    // All members must be static
}</code></pre>
                        </div>
                        
                        <ul class="list-disc pl-5 mt-6 space-y-2">
                            <li><strong><code>static</code> Keyword:</strong> The class declaration must include the <code>static</code> modifier.</li>
                            <li><strong>Non-Instantiable:</strong> The compiler prevents instantiation with the <code>new</code> operator.</li>
                            <li><strong>Static-Only Members:</strong> All members (fields, properties, methods) must also be declared <code>static</code>.</li>
                            <li><strong>Implicitly <code>sealed</code>:</strong> A static class cannot be used as a base class (cannot be inherited from).</li>
                            <li><strong>Static Constructor:</strong> A static class can have a single, parameterless static constructor, invoked automatically by the CLR at most once, just before the first access to any static member. This is ideal for initializing static state.</li>
                        </ul>

                        <h4 class="mt-6">Example: Static Class with Constructor</h4>
                        <div class="code-block mt-2">
                            <pre class="p-4 rounded-lg overflow-x-auto"><code class="language-csharp">public static class AppConfiguration
{
    public static readonly string DatabaseConnectionString;
    
    // Static constructor: Runs once to initialize static fields.
    static AppConfiguration()
    {
        Console.WriteLine("Initializing configuration...");
        // In a real app, this would load from a file or environment variable
        DatabaseConnectionString = "Server=myServer;Database=myDataBase;";
    }
}</code></pre>
                        </div>
                    </section>
                    
                    <section id="s2" class="section-target mb-16">
                        <h2 class="border-b border-slate-200 pb-3 mb-6">Section 2: The Data Pattern â€” C# Records</h2>
                        <p>Introduced in C# 9 and enhanced in C# 10, <strong>records</strong> are a specialized reference type (or value type with <code>record struct</code>) designed for encapsulating data. They simplify the creation of immutable, data-centric types by providing compiler-synthesized members for common data-related tasks.</p>
                        
                        <h3 id="s2-1" class="section-target mt-10">2.1. The Three Pillars of Records</h3>
                        
                        <p class="mt-4"><strong>Pillar 1: Concise Syntax (Positional Records)</strong></p>
                        <p>Positional records offer a highly compact syntax for defining a type and its constructor. The compiler generates public <code>init</code>-only properties, a primary constructor, and a deconstructor from this single line.</p>
                        
                        <h4 class="mt-6">Syntax: Positional Record</h4>
                        <div class="code-block mt-2">
                           <pre class="rounded-lg"><code class="language-csharp">public record Person(string FirstName, string LastName);</code></pre>
                        </div>
                        
                        <p class="mt-6"><strong>Pillar 2: Value-Based Equality</strong></p>
                        <p>Unlike classes, which default to reference equality (two objects are equal only if they are the same instance), records implement value-based equality. Two record instances are equal if they are of the same type and all their public properties have the same values.</p>
                        
                        <h4 class="mt-6">Example: Value Equality</h4>
                        <div class="code-block mt-2">
                           <pre class="rounded-lg"><code class="language-csharp">var person1 = new Person("John", "Doe");
var person2 = new Person("John", "Doe");
Console.WriteLine(person1 == person2);         // Output: True
Console.WriteLine(person1.Equals(person2));    // Output: True</code></pre>
                        </div>

                        <p class="mt-6"><strong>Pillar 3: Immutability by Default</strong></p>
                        <p>The properties generated for a positional record use an <code>init</code> accessor. This means their values can only be set during object creation (via the constructor or an object initializer). Once created, the object's state cannot be changed, which enhances thread safety and predictability.</p>
                        
                        <h3 id="s2-2" class="section-target mt-10">2.2. Non-Destructive Mutation with `with`</h3>
                        <p>To accommodate changes in an immutable world, the <code>with</code> expression provides a way to create a new record instance that is a shallow copy of an existing one, but with specified properties modified. The original record remains untouched.</p>
                        
                        <h4 class="mt-6">Syntax: `with` Expression</h4>
                        <div class="code-block mt-2">
                           <pre class="rounded-lg"><code class="language-csharp">var originalUser = new User("Bob", "Reader");
var updatedUser = originalUser with { Name = "Robert" };

// originalUser is unchanged. updatedUser is a new instance.
Console.WriteLine(originalUser.Name);   // Output: Bob
Console.WriteLine(updatedUser.Name);    // Output: Robert</code></pre>
                        </div>
                    </section>

                    <section id="s3" class="section-target mb-16">
                        <h2 class="border-b border-slate-200 pb-3 mb-6">Section 3: In-Depth Comparisons</h2>
                        <p>Choosing the right tool for the job is a hallmark of a great software architect. This section provides detailed comparisons between related concepts to help you make informed design decisions.</p>
                        
                        <h3 id="s3-1" class="section-target mt-10">3.1. Architectural Crossroads: Static Class vs. Singleton</h3>
                        <p>A common point of confusion is when to use a static class versus the Singleton design pattern. The key distinction lies in their intent: <strong>static classes are for stateless behavior</strong>, while <strong>singletons manage a single instance of a stateful object</strong>.</p>
                        <div class="overflow-x-auto mt-6">
                            <table class="min-w-full divide-y divide-slate-200 border border-slate-200 rounded-lg not-prose">
                                <thead class="bg-slate-100">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Feature</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Static Class</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Singleton Pattern</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-slate-200 text-sm">
                                    <tr><td class="px-6 py-4 font-semibold">Core Intent</td><td class="px-6 py-4">Group stateless utility functions.</td><td class="px-6 py-4">Ensure exactly one instance of a stateful object.</td></tr>
                                    <tr><td class="px-6 py-4 font-semibold">State</td><td class="px-6 py-4">Should be stateless. Mutable static fields are an anti-pattern.</td><td class="px-6 py-4">Explicitly designed to manage and encapsulate state.</td></tr>
                                    <tr><td class="px-6 py-4 font-semibold">Instantiation</td><td class="px-6 py-4">Cannot be instantiated. Accessed directly via class name.</td><td class="px-6 py-4">Instantiated once, accessed via a static property/method.</td></tr>
                                    <tr><td class="px-6 py-4 font-semibold">Interfaces</td><td class="px-6 py-4">Cannot implement interfaces.</td><td class="px-6 py-4">Can implement interfaces, allowing for abstraction.</td></tr>
                                    <tr><td class="px-6 py-4 font-semibold">Testability</td><td class="px-6 py-4">Difficult to mock/stub, leading to brittle tests.</td><td class="px-6 py-4">Can be mocked via its interface, enabling unit testing.</td></tr>
                                    <tr><td class="px-6 py-4 font-semibold">Dependency Injection</td><td class="px-6 py-4">Incompatible. Creates a hard-coded dependency.</td><td class="px-6 py-4">Compatible. The dependency can be injected as its interface.</td></tr>
                                </tbody>
                            </table>
                        </div>

                        <h3 id="s3-2" class="section-target mt-10">3.2. Data Modeling: Class vs. Record</h3>
                        <p>While records are technically classes (or structs), their purpose and compiler-generated features make them distinct. Choose a record when your primary goal is to model data, especially if immutability is desired.</p>
                        <div class="overflow-x-auto mt-6">
                            <table class="min-w-full divide-y divide-slate-200 border border-slate-200 rounded-lg not-prose">
                                <thead class="bg-slate-100">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Feature</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Standard Class</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Record</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-slate-200 text-sm">
                                    <tr><td class="px-6 py-4 font-semibold">Primary Purpose</td><td class="px-6 py-4">Behavior and state encapsulation (e.g., services, entities).</td><td class="px-6 py-4">Data encapsulation, typically immutable (e.g., DTOs, value objects).</td></tr>
                                    <tr><td class="px-6 py-4 font-semibold">Equality</td><td class="px-6 py-4">Reference equality by default (<code>a == b</code> is true only if they are the same object).</td><td class="px-6 py-4">Value-based equality by default (<code>a == b</code> is true if all property values match).</td></tr>
                                    <tr><td class="px-6 py-4 font-semibold">Immutability</td><td class="px-6 py-4">Must be implemented manually (e.g., private setters, readonly fields).</td><td class="px-6 py-4">Encouraged by default via <code>init</code>-only properties and <code>with</code> expressions.</td></tr>
                                    <tr><td class="px-6 py-4 font-semibold">Boilerplate</td><td class="px-6 py-4">Requires manual implementation of constructor, <code>Equals</code>, <code>GetHashCode</code>, <code>ToString</code>.</td><td class="px-6 py-4">Compiler generates these members automatically, reducing code.</td></tr>
                                    <tr><td class="px-6 py-4 font-semibold">Best For</td><td class="px-6 py-4">Services, business logic controllers, UI components.</td><td class="px-6 py-4">Data Transfer Objects (DTOs), API responses, events, value objects.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                    
                    <section id="s4" class="section-target mb-16">
                        <h2 class="border-b border-slate-200 pb-3 mb-6">Section 4: Coding Practice & Solutions</h2>
                        <p>Apply your knowledge with these practical coding exercises. Full solutions with detailed comments are provided for you to review.</p>
                        
                        <h3 id="s4-1" class="section-target mt-10">4.1. [Easy] String Extension Methods</h3>
                        <p><strong>Problem:</strong> Create a static class named <code>StringExtensions</code>. Inside it, implement an extension method called <code>Truncate</code> that shortens a string to a specified length and appends "..." if it was truncated. The method signature should be <code>public static string Truncate(this string value, int maxLength)</code>.</p>
                        
                        <h4 class="mt-6">Solution: `StringExtensions.cs`</h4>
                        <div class="code-block mt-2">
                           <pre class="p-4 rounded-lg overflow-x-auto"><code class="language-csharp">// Solution for 4.1: String Extension Methods
public static class StringExtensions
{
    /// &lt;summary&gt;
    /// Truncates a string to a specified maximum length and appends an ellipsis.
    /// &lt;/summary&gt;
    /// &lt;param name="value"&gt;The string to truncate. The 'this' keyword makes it an extension method.&lt;/param&gt;
    /// &lt;param name="maxLength"&gt;The maximum length of the returned string, including the ellipsis.&lt;/param&gt;
    /// &lt;returns&gt;The truncated string, or the original string if it's shorter than maxLength.&lt;/returns&gt;
    public static string Truncate(this string value, int maxLength)
    {
        // Handle null or empty strings gracefully.
        if (string.IsNullOrEmpty(value))
        {
            return value;
        }

        // If the string is already short enough, no need to truncate.
        if (value.Length <= maxLength)
        {
            return value;
        }

        // Truncate the string and append the ellipsis.
        // We subtract 3 from maxLength to make space for "...".
        return value.Substring(0, maxLength - 3) + "...";
    }
}

// Example Usage:
// string longText = "This is a very long sentence that needs to be truncated.";
// string shortText = longText.Truncate(20); // "This is a very..."
</code></pre>
                        </div>
                        
                        <h3 id="s4-2" class="section-target mt-10">4.2. [Medium] GPS Coordinate Record</h3>
                        <p><strong>Problem:</strong> Define a <code>record struct</code> named <code>GpsCoordinate</code> with <code>double Latitude</code> and <code>double Longitude</code> properties. Create a static class <code>GeoCalculator</code> with a method <code>CalculateDistance</code> that takes two <code>GpsCoordinate</code> records and calculates the distance between them in kilometers using the Haversine formula (provided). The method should be thread-safe.</p>
                        
                        <h4 class="mt-6">Solution: `GpsCoordinate.cs` and `GeoCalculator.cs`</h4>
                        <div class="code-block mt-2">
                           <pre class="p-4 rounded-lg overflow-x-auto"><code class="language-csharp">// Solution for 4.2: GPS Coordinate Record

// Using a 'record struct' is ideal here because GPS coordinates are
// small, simple value types. It provides immutability and value equality.
public readonly record struct GpsCoordinate(double Latitude, double Longitude);

public static class GeoCalculator
{
    private const double EarthRadiusKm = 6371.0;

    /// &lt;summary&gt;
    /// Calculates the distance between two GPS coordinates using the Haversine formula.
    /// This method is inherently thread-safe because it's a pure function:
    /// it has no side effects and its output depends only on its inputs.
    /// It doesn't modify any shared static state.
    /// &lt;/summary&gt;
    public static double CalculateDistance(GpsCoordinate start, GpsCoordinate end)
    {
        // Convert degrees to radians
        double lat1Rad = ToRadians(start.Latitude);
        double lon1Rad = ToRadians(start.Longitude);
        double lat2Rad = ToRadians(end.Latitude);
        double lon2Rad = ToRadians(end.Longitude);

        // Haversine formula implementation
        double dLat = lat2Rad - lat1Rad;
        double dLon = lon2Rad - lon1Rad;
        double a = Math.Sin(dLat / 2) * Math.Sin(dLat / 2) +
                   Math.Cos(lat1Rad) * Math.Cos(lat2Rad) *
                   Math.Sin(dLon / 2) * Math.Sin(dLon / 2);
        double c = 2 * Math.Atan2(Math.Sqrt(a), Math.Sqrt(1 - a));
        
        return EarthRadiusKm * c;
    }

    // A private helper method within the static class.
    private static double ToRadians(double degrees)
    {
        return degrees * (Math.PI / 180.0);
    }
}

// Example Usage:
// var eiffelTower = new GpsCoordinate(48.8584, 2.2945);
// var notreDame = new GpsCoordinate(48.8530, 2.3499);
// double distance = GeoCalculator.CalculateDistance(eiffelTower, notreDame);
// Console.WriteLine($"Distance: {distance:F2} km"); // ~4.12 km
</code></pre>
                        </div>
                    </section>
                    
                    <section id="s5" class="section-target mb-16">
                        <h2 class="border-b border-slate-200 pb-3 mb-6">Section 5: Case Study â€” Payment Processing Service</h2>
                        <p>This case study synthesizes our concepts. We will design a simple payment processing service, leveraging each C# feature for its intended purpose: records for immutable data, static classes for stateless utilities, and regular classes for stateful services.</p>
                        
                        <h3 id="s5-1" class="section-target mt-10">5.1. Architectural Blueprint</h3>
                        <ol class="list-decimal pl-5 space-y-2">
                          <li><strong><code>Transaction</code> Record:</strong> Represents an immutable payment transaction. A transaction is a historical fact and should not be altered once created.</li>
                          <li><strong><code>PaymentValidator</code> Static Class:</strong> Provides pure, stateless functions for validating payment details (e.g., credit card number format). This logic requires no instance state.</li>
                          <li><strong><code>PaymentService</code> Class:</strong> A standard, instantiable class that orchestrates the payment process. It holds state (like a logger or configuration) and contains the core business logic.</li>
                        </ol>

                        <h3 id="s5-2" class="section-target mt-10">5.2. Full Implementation</h3>
                        
                        <h4 class="mt-6">Step 1: The `Transaction` Record (Data)</h4>
                        <div class="code-block mt-2">
                           <pre class="p-4 rounded-lg overflow-x-auto"><code class="language-csharp">public record Transaction(
    string TransactionId,
    decimal Amount,
    string Currency,
    string CardNumber,
    DateTime Timestamp,
    string Status
);</code></pre>
                        </div>
                        
                        <h4 class="mt-6">Step 2: The `PaymentValidator` Static Class (Utility)</h4>
                        <div class="code-block mt-2">
                           <pre class="p-4 rounded-lg overflow-x-auto"><code class="language-csharp">public static class PaymentValidator
{
    // A simple (not production-ready) validation.
    public static bool IsValidCardNumber(string cardNumber)
    {
        if (string.IsNullOrWhiteSpace(cardNumber)) return false;
        return cardNumber.Length >= 13 && cardNumber.Length <= 19 && cardNumber.All(char.IsDigit);
    }

    public static bool IsValidAmount(decimal amount)
    {
        return amount > 0;
    }
}</code></pre>
                        </div>

                        <h4 class="mt-6">Step 3: The `PaymentService` Class (Behavior & State)</h4>
                        <div class="code-block mt-2">
                           <pre class="p-4 rounded-lg overflow-x-auto"><code class="language-csharp">public class PaymentService
{
    // A service might have dependencies and state, making it a regular class.
    private readonly ILogger _logger;

    public PaymentService(ILogger logger)
    {
        _logger = logger;
    }

    public Transaction ProcessPayment(decimal amount, string currency, string cardNumber)
    {
        _logger.Log($"Attempting payment for {amount} {currency}...");

        // Use the static utility class for validation.
        if (!PaymentValidator.IsValidCardNumber(cardNumber) || !PaymentValidator.IsValidAmount(amount))
        {
            _logger.LogError("Invalid payment details.");
            return new Transaction(Guid.NewGuid().ToString(), amount, currency, cardNumber, DateTime.UtcNow, "Failed");
        }

        // ... logic to call a real payment gateway ...

        _logger.Log("Payment successful.");
        return new Transaction(Guid.NewGuid().ToString(), amount, currency, cardNumber, DateTime.UtcNow, "Success");
    }
}

// Dummy ILogger interface for demonstration
public interface ILogger { void Log(string message); void LogError(string message); }
public class ConsoleLogger : ILogger 
{
    public void Log(string message) => Console.WriteLine($"[INFO] {message}");
    public void LogError(string message) => Console.WriteLine($"[ERROR] {message}");
}
</code></pre>
                        </div>
                    </section>
                    
                    <section id="s6" class="section-target mb-16">
                        <h2 class="border-b border-slate-200 pb-3 mb-6">Section 6: Knowledge Assessment</h2>
                        <p>Complete this expanded quiz to check your grasp of the key concepts. Select an answer for each question and then click "Check Answers" to see your score and the correct solutions.</p>
                        <div id="quiz-container" class="mt-8 space-y-8 bg-white p-6 rounded-lg shadow not-prose"></div>
                        <div class="mt-6 text-center">
                            <button id="check-quiz-btn" class="bg-indigo-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-indigo-700 transition-colors">Check Answers</button>
                        </div>
                        <div id="quiz-results" class="mt-6 hidden">
                            <h3 id="quiz-score" class="text-2xl font-bold text-center"></h3>
                            <div id="quiz-feedback" class="mt-4 space-y-4"></div>
                        </div>
                    </section>
                    
                    <section id="s7" class="section-target">
                        <h2 class="border-b border-slate-200 pb-3 mb-6">Section 7: Self-Assessment Challenge</h2>
                        <p>It's time to put it all together. This challenge requires you to apply the principles of static classes and records to build a small, coherent system.</p>
                        <h3 id="s7-1" class="section-target mt-10">Challenge: Simple Inventory System</h3>
                        <p><strong>Requirements:</strong></p>
                        <ol class="list-decimal pl-5 space-y-2">
                            <li>Create an immutable <code>InventoryItem</code> <strong>record</strong> with properties: <code>string Sku</code>, <code>string Name</code>, and <code>int Quantity</code>.</li>
                            <li>Create a <code>SkuValidator</code> <strong>static class</strong> with a method <code>public static bool IsValidFormat(string sku)</code>. A valid SKU must be exactly 8 characters long and contain only uppercase letters and numbers.</li>
                            <li>Create an <code>InventoryManager</code> <strong>class</strong>. It should have a private dictionary to hold inventory items (<code>Dictionary&lt;string, InventoryItem&gt;</code>).</li>
                            <li>Implement an <code>AddItem</code> method in <code>InventoryManager</code>. This method should take a SKU, name, and quantity. It must use the <code>SkuValidator</code> before adding a new <code>InventoryItem</code> to the dictionary. If the SKU is invalid or already exists, it should return <code>false</code>. Otherwise, it adds the item and returns <code>true</code>.</li>
                            <li>Implement a <code>GetItem</code> method in <code>InventoryManager</code> that retrieves an item by its SKU.</li>
                        </ol>
                        <div class="mt-6 text-center">
                            <button id="reveal-solution-btn" class="bg-slate-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-slate-700 transition-colors">Reveal Solution</button>
                        </div>
                        <div id="solution-container" class="solution-hidden mt-6">
                            <h3 class="mt-10">Challenge Solution</h3>
                            <p>Below is a complete, commented solution for the Simple Inventory System challenge.</p>
                            <div class="code-block mt-4">
                               <pre class="p-4 rounded-lg overflow-x-auto"><code class="language-csharp">// Step 1: The InventoryItem record
// A record is perfect for representing an inventory item as a simple, immutable data container.
public record InventoryItem(string Sku, string Name, int Quantity);

// Step 2: The SkuValidator static class
// Validation logic is stateless and global, making a static class the ideal choice.
public static class SkuValidator
{
    private const int SkuLength = 8;

    public static bool IsValidFormat(string sku)
    {
        if (string.IsNullOrEmpty(sku) || sku.Length != SkuLength)
        {
            return false;
        }

        // Ensure all characters are uppercase letters or digits.
        foreach (char c in sku)
        {
            if (!char.IsUpper(c) && !char.IsDigit(c))
            {
                return false;
            }
        }
        return true;
    }
}

// Step 3, 4, 5: The InventoryManager class
// This class holds state (the inventory dictionary) and behavior, so it's a standard class.
public class InventoryManager
{
    private readonly Dictionary<string, InventoryItem> _inventory = new();

    public bool AddItem(string sku, string name, int quantity)
    {
        // Use the static validator class.
        if (!SkuValidator.IsValidFormat(sku))
        {
            Console.WriteLine($"Error: SKU '{sku}' has an invalid format.");
            return false;
        }

        if (_inventory.ContainsKey(sku))
        {
            Console.WriteLine($"Error: SKU '{sku}' already exists.");
            return false;
        }

        var newItem = new InventoryItem(sku, name, quantity);
        _inventory.Add(sku, newItem);
        Console.WriteLine($"Successfully added item: {newItem}");
        return true;
    }

    public InventoryItem? GetItem(string sku)
    {
        _inventory.TryGetValue(sku, out var item);
        return item; // Returns null if not found
    }
}

// Example Usage:
// var manager = new InventoryManager();
// manager.AddItem("ABC123DE", "Laptop", 10);      // Success
// manager.AddItem("12345678", "Mouse", 50);      // Success
// manager.AddItem("abc-123", "Keyboard", 25);    // Fails validation
// manager.AddItem("ABC123DE", "Gaming PC", 5); // Fails (already exists)
</code></pre>
                            </div>
                        </div>
                    </section>
                </div>
            </main>
        </div>
    </div>
    
    <footer class="text-center mt-16 py-8 border-t border-slate-200">
        <p class="text-slate-700 font-semibold">Low-Level Design Bootcamp</p>
        <p class="text-sm text-slate-500 mt-2">A personalized learning roadmap curated by Mr. Mahesh Singare.</p>
        <p class="text-xs text-slate-400 mt-4">&copy; 2025. All Rights Reserved.</p>
    </footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
    
    // --- Code Block Copy Functionality ---
    document.querySelectorAll('.code-block').forEach(block => {
        const code = block.querySelector('code');
        const button = document.createElement('button');
        button.textContent = 'Copy';
        button.className = 'copy-button';
        block.appendChild(button);

        button.addEventListener('click', () => {
            navigator.clipboard.writeText(code.innerText).then(() => {
                button.textContent = 'Copied!';
                setTimeout(() => { button.textContent = 'Copy'; }, 2000);
            });
        });
    });

    // --- TOC & Scroll-Spy Functionality ---
    const mainContent = document.getElementById('main-content');
    const tocNav = document.getElementById('toc-nav');
    const sections = mainContent.querySelectorAll('.section-target');

    // Generate TOC
    if(tocNav) {
        sections.forEach(section => {
            const titleEl = section.querySelector('h2, h3');
            if (titleEl) {
                const id = section.getAttribute('id');
                const title = titleEl.textContent;
                const link = document.createElement('a');
                link.href = `#${id}`;
                link.textContent = title;
                link.className = `toc-link transition-all duration-200 hover:text-indigo-600 ${titleEl.tagName === 'H3' ? 'pl-4' : ''}`;
                tocNav.appendChild(link);
            }
        });
    }

    const tocLinks = tocNav ? tocNav.querySelectorAll('.toc-link') : [];
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            const id = entry.target.getAttribute('id');
            const link = tocNav ? tocNav.querySelector(`a[href="#${id}"]`) : null;
            if (entry.isIntersecting && entry.intersectionRatio >= 0.5) {
                tocLinks.forEach(l => l.classList.remove('active'));
                if(link) link.classList.add('active');
            }
        });
    }, { rootMargin: '0px 0px -50% 0px', threshold: 0.5 });

    sections.forEach(section => observer.observe(section));

    // --- Quiz Functionality ---
    const quizData = [
        { q: "Which of the following is NOT a feature of a C# static class?", o: ["Cannot be instantiated.", "Can implement interfaces.", "Is implicitly sealed.", "Can only contain static members."], a: 1, e: "Static classes cannot be instantiated, so they cannot fulfill an interface contract which often requires instance members." },
        { q: "When is the static constructor of a class called?", o: ["Every time a static method is called.", "Only once, before the first time any member of the class is accessed.", "Every time an object of the class is created.", "It must be called manually."], a: 1, e: "The CLR guarantees this behavior for thread-safe initialization, calling it at most once before the first member access." },
        { q: "What is the primary purpose of the `record` type in C#?", o: ["To define classes with complex, stateful behavior.", "To create types for performance-critical calculations.", "To provide a concise syntax for creating immutable, data-centric types with value equality.", "To replace the need for structs."], a: 2, e: "Records are specifically designed to reduce boilerplate for data-centric types, focusing on immutability and value semantics." },
        { q: "True or False: Two `record` instances with identical property values will be considered equal by the `==` operator.", o: ["True", "False"], a: 0, e: "Records have compiler-synthesized value equality, which includes an override for the `==` operator." },
        { q: "What does the `with` expression do when used with a record?", o: ["It modifies the properties of the existing record instance.", "It creates a new record instance by copying the original and applying changes.", "It can only be used to change one property at a time.", "It converts a record to a class."], a: 1, e: "This is called non-destructive mutation and is key to working with immutable types, as it leaves the original object unchanged." },
        { q: "What is the primary risk of using a mutable public static field in a multithreaded application?", o: ["Poor performance due to garbage collection.", "A StackOverflowException.", "Race conditions leading to data corruption.", "Inability to access the field from other assemblies."], a: 2, e: "Unsynchronized access to shared mutable state is a primary cause of concurrency bugs like race conditions." },
        { q: "In a UML class diagram, what is the standard way to denote a static method?", o: ["Writing the method name in italics.", "Underlining the method name.", "Prefixing the method name with a * symbol.", "Using the <<static>> stereotype next to the method."], a: 1, e: "Underlining is the standard UML convention for all static members (attributes and operations)." },
        { q: "Which of the following is the best use case for a C# record?", o: ["A database connection manager.", "A service that sends emails.", "A Data Transfer Object (DTO) for an API response.", "A UI button controller."], a: 2, e: "DTOs are purely for holding data, which is the exact scenario records were designed to simplify." },
        { q: "An extension method in C# must be defined inside a...", o: ["record", "sealed class", "static class", "partial class"], a: 2, e: "The C# language specification requires that all extension methods be declared as static methods in a non-generic, non-nested static class." },
        { q: "What does the `init` keyword in a property accessor signify?", o: ["The property can only be set in the constructor.", "The property can be set at any time.", "The property can only be set during object initialization (constructor or object initializer).", "The property is thread-safe."], a: 2, e: "`init` provides a middle ground, allowing the flexibility of object initializers while still enforcing immutability after the object is created." }
    ];

    const quizContainer = document.getElementById('quiz-container');
    const checkBtn = document.getElementById('check-quiz-btn');
    const resultsContainer = document.getElementById('quiz-results');
    const scoreEl = document.getElementById('quiz-score');
    const feedbackEl = document.getElementById('quiz-feedback');

    function buildQuiz() {
        quizData.forEach((item, index) => {
            const questionDiv = document.createElement('div');
            questionDiv.id = `question-${index}`;
            let optionsHTML = item.o.map((option, i) => `
                <label class="block flex items-center p-3 rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors cursor-pointer">
                    <input type="radio" name="q${index}" value="${i}" class="mr-3 h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300">
                    <span>${option}</span>
                </label>
            `).join('');
            questionDiv.innerHTML = `<p class="font-semibold text-slate-800">${index + 1}. ${item.q}</p><div class="mt-3 space-y-2">${optionsHTML}</div>`;
            quizContainer.appendChild(questionDiv);
        });
    }

    function checkAnswers() {
        let score = 0;
        feedbackEl.innerHTML = ''; 

        quizData.forEach((item, index) => {
            const qDiv = document.getElementById(`question-${index}`);
            const selected = qDiv.querySelector(`input:checked`);
            const feedbackDiv = document.createElement('div');
            feedbackDiv.className = 'p-4 rounded-lg text-sm';

            if (!selected) {
                 feedbackDiv.innerHTML = `<p class="font-bold">${index + 1}. ${item.q}</p><p class="mt-1 text-amber-800">No answer selected.</p>`;
                 feedbackDiv.classList.add('bg-amber-50');
            } else {
                const userAnswer = parseInt(selected.value);
                qDiv.querySelectorAll('label').forEach((label, i) => {
                    label.classList.remove('bg-red-100', 'border-red-300', 'bg-green-100', 'border-green-300');
                    if (i === item.a) label.classList.add('bg-green-100', 'border-green-300');
                    if (i === userAnswer && userAnswer !== item.a) label.classList.add('bg-red-100', 'border-red-300');
                });

                if (userAnswer === item.a) {
                    score++;
                    feedbackDiv.innerHTML = `<p class="font-bold text-green-800">${index + 1}. Correct!</p><p class="mt-1 text-slate-700">${item.e}</p>`;
                    feedbackDiv.classList.add('bg-green-50');
                } else {
                    feedbackDiv.innerHTML = `<p class="font-bold text-red-800">${index + 1}. Incorrect.</p><p class="mt-1 text-slate-700">${item.e}</p>`;
                    feedbackDiv.classList.add('bg-red-50');
                }
            }
            feedbackEl.appendChild(feedbackDiv);
        });

        scoreEl.textContent = `Your Score: ${score} out of ${quizData.length}`;
        resultsContainer.classList.remove('hidden');
        resultsContainer.scrollIntoView({ behavior: 'smooth' });
    }

    buildQuiz();
    checkBtn.addEventListener('click', checkAnswers);

    // --- Self-Assessment Solution Reveal ---
    const revealBtn = document.getElementById('reveal-solution-btn');
    const solutionContainer = document.getElementById('solution-container');

    revealBtn.addEventListener('click', () => {
        solutionContainer.classList.toggle('solution-hidden');
        revealBtn.textContent = solutionContainer.classList.contains('solution-hidden') ? 'Reveal Solution' : 'Hide Solution';
    });
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

</body>
</html>

